<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
    .metrics {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }
    .metrics div {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .charts-container {
    display: flex;
    gap: 30px;
    margin-top: 40px;
    flex-wrap: wrap;
}

.chart-box {
    flex: 1;
    min-width: 400px;
    height: 400px;
}
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Health Dashboard</h1>
    <body>

  <h1>Dashboard</h1>

  <h2>Summary Metrics (Last 7 Entries)</h2>

  <div class="metrics">
    <div><strong>7-Day Avg Mood:</strong> {{ analysis.avg_mood_7d }}</div>
    <div><strong>Mood Volatility:</strong> {{ analysis.mood_volatility }}</div>
    <div><strong>Avg Sleep (hrs):</strong> {{ analysis.avg_sleep }}</div>
    <div><strong>Mood Trend:</strong> {{ analysis.trend_label }}</div>
    <p><strong>Overall Insight:</strong> {{ analysis.summary_text }}</p>
  </div>

  <!-- Existing Sentiment / Alerts / Journals below -->

</body>
    <div class="metric-card">
        <h3>Average Sentiment Score: {{ analysis.sentiment|round(2) }}</h3>
    </div>
    <div class="metric-card">
        <h3>Mood Trend: {{ analysis.mood_trend }}</h3>
    </div>
    <div class="metric-card">
    <h3>
        Mood Volatility: 
        {{ analysis.mood_volatility }} 
        ({{ analysis.volatility_label }})
    </h3>
</div>

<div class="metric-card">
    <h3>
        Mood vs Sleep Correlation:
        {{ analysis.correlation }}
        ({{ analysis.correlation_label }})
    </h3>
</div>
    {% if analysis.alerts %}
    <div class="metric-card alert">
        <h3>Alerts:</h3>
        <ul>
            {% for alert in analysis.alerts %}
            <li>{{ alert }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
<div class="charts-container">
    <div class="chart-box">
        <canvas id="moodChart"></canvas>
    </div>

    <div class="chart-box">
        <canvas id="scatterChart"></canvas>
    </div>
</div>
<script>
    window.moodDates = {{ analysis.mood_dates | tojson }};
    window.moodValues = {{ analysis.mood_values | tojson }};
    window.rollingValues = {{ analysis.rolling_values | tojson }};
    window.sleepValues = {{ analysis.sleep_values | tojson }};
    window.moodValuesScatter = {{ analysis.mood_values_scatter | tojson }};
    window.stabilityValues = {{ analysis.stability_values | tojson }}; 
</script>
<script src="{{ url_for('static', filename='js/charts.js') }}"></script>
    
    <a href="{{ url_for('journals') }}">View Journal Entries</a>
    <a href="{{ url_for('home') }}">Back Home</a>
</body>
</html>
